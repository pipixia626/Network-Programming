# 锁定中的几个概念

文件锁定的是整个文件，而记录锁定只锁定文件的某一特定部分。UNIX 的记录指的
是从文件的某一相对位置开始的一段连续的字节流，它不同于其它以强制性记录结构阻止文件的操作系统，因此，UNIX 记录锁更恰当的称呼应该是范围锁，它是对文件某个范围的锁定。

文件和记录锁定可分为咨询式锁定和强制锁定两种。
当正在运行的某一进程对它将要
访问的某一文件进行了咨询式锁定后，其它想要访问该文件的进程将被操作系统告知共享文件已经上了锁，但这并不阻止它们对锁定文件的操作。只要有对锁定文件的存取权，这
些进程便可忽视咨询式锁定而去写赏了锁的文件。强制锁定的含义则要严格多了，当某一共享文件被强制后，操作系统将会对每个读写文件的请求进行核查，只有在确证该请求不
会干扰上了锁的文件时，才允许对应的操作。System V和 BSD 都提供了咨询式锁定方式。
这两种锁定方式都被 Linux 支持。

1．System V的锁定方式是记录锁定，可以指定锁定的范围。而 BSD 的锁定方式是文
件锁定，只能指定锁定文件。
2．System V 的锁定是每个进程所独有的，可以用于父子进程间的共享锁定。而 BSD
的锁定方式是可以继承的，父子进程间使用的是同一锁定的，所以不能用于父子进程间的
文件共享锁定。
